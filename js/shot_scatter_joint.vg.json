{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Scatter + outside histograms with court background. MJ 1996-97, hoop at bottom.",
  "background": "transparent",
  "config": {
    "view": { "stroke": null },
    "axis": { "grid": false, "domain": false, "ticks": false, "labels": false, "title": null }
  },

  "params": [
    { "name": "xMin", "value": -250 },
    { "name": "xMax", "value": 250 },
    { "name": "yMin", "value": -47.5 },
    { "name": "yMax", "value": 422.5 }
  ],

  "data": {
    "url": "https://raw.githubusercontent.com/JenqAu/FIT3179---fix/refs/heads/backup-main/data/shot_data.csv",
    "format": {
      "type": "csv",
      "parse": { "LOC_X": "number", "LOC_Y": "number" }
    }
  },

  "transform": [
    { "filter": "datum.PLAYER_NAME == 'Michael Jordan'" },
  { "filter": "datum.SEASON == '1996-97 Season'" },
  { "calculate": "datum.SHOT_MADE_FLAG == 1 ? 'Made' : 'Missed'", "as": "ShotOutcome" },
  { "calculate": "datum.SHOT_TYPE == 3 ? '3PT Field Goal' : '2PT Field Goal'", "as": "ShotTypeLabel" }
  ],

  "vconcat": [
    {
      "width": 440,
      "height": 70,
      "data": {"url": "https://raw.githubusercontent.com/JenqAu/FIT3179---fix/refs/heads/backup-main/data/shot_data.csv", "format": {"type": "csv", "parse": {"LOC_X": "number", "LOC_Y": "number"}}},
      "transform": [
        {"filter": "datum.PLAYER_NAME == 'Michael Jordan'"},
        {"filter": "datum.SEASON == '1996-97 Season'"},
  {"density": "LOC_X", "bandwidth": 8, "extent": [-250, 250], "counts": false}
      ],
      "mark": {"type": "area", "interpolate": "monotone", "color": "#94a3b8", "opacity": 0.6},
      "encoding": {
        "x": {"field": "value", "type": "quantitative", "scale": {"domain": [{"expr": "xMin"}, {"expr": "xMax"}], "nice": false}, "axis": null},
        "y": {"field": "density", "type": "quantitative", "axis": null}
      },
  "view": {"stroke": null}
    },

    {
      "hconcat": [
        {
          "width": 440,
          "height": 414,
          "layer": [
            {
              "data": {
                "values": [
                  { "x": -250, "x2": 250, "y": -47.5, "y2": 422.5, "img": "../data/court.png" }
                ]
              },
              "mark": { "type": "image", "opacity": 0.5 },
              "encoding": {
                "x": {
                  "field": "x",
                  "type": "quantitative",
                  "scale": { "domain": [{ "expr": "xMin" }, { "expr": "xMax" }], "nice": false },
                  "axis": null
                },
                "x2": { "field": "x2" },
                "y": {
                  "field": "y",
                  "type": "quantitative",
                  "scale": { "domain": [{ "expr": "yMin" }, { "expr": "yMax" }], "nice": false },
                  "axis": null
                },
                "y2": { "field": "y2" },
                "url": { "field": "img" }
              }
            },
            {
              "mark": { "type": "point", "filled": true, "size": 55, "opacity": 0.6, "color": "#5ba4ff" },
              "encoding": {
                "x": {
                  "field": "LOC_X",
                  "type": "quantitative",
                  "scale": { "domain": [{ "expr": "xMin" }, { "expr": "xMax" }], "nice": false },
                  "axis": null
                },
                "y": {
                  "field": "LOC_Y",
                  "type": "quantitative",
                  "scale": { "domain": [{ "expr": "yMin" }, { "expr": "yMax" }], "nice": false },
                  "axis": null
                },
                "tooltip": [
                  {"field": "PLAYER_NAME", "title": "Player"},
                  {"field": "ShotTypeLabel", "title": "Shot Type"},
                  {"field": "SHOT_DISTANCE", "title": "Distance (ft)", "format": ".0f"}
                ]
              }
            }
          ],
          "view": { "stroke": null }
        },

        {
          "width": 70,
          "height": 414,
          "data": {"url": "https://raw.githubusercontent.com/JenqAu/FIT3179---fix/refs/heads/backup-main/data/shot_data.csv", "format": {"type": "csv", "parse": {"LOC_X": "number", "LOC_Y": "number"}}},
          "transform": [
            {"filter": "datum.PLAYER_NAME == 'Michael Jordan'"},
            {"filter": "datum.SEASON == '1996-97 Season'"},
            {"density": "LOC_Y", "bandwidth": 8, "extent": [-47.5, 422.5], "counts": false}
          ],
          "mark": {"type": "area", "orient": "horizontal", "interpolate": "monotone", "color": "#94a3b8", "opacity": 0.6},
          "encoding": {
            "y": {"field": "value", "type": "quantitative", "scale": {"domain": [{"expr": "yMin"}, {"expr": "yMax"}], "nice": false}, "axis": null},
            "x": {"field": "density", "type": "quantitative", "axis": null}
          },
          "view": {"stroke": null}
        }
      ],
      "spacing": 0,
      "resolve": { "scale": { "x": "independent", "y": "shared" } }
    }
  ],

  "spacing": 0
}