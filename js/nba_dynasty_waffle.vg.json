{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "NBA team dynasties shown as symbolic waffle charts â€” each ðŸ’ = one championship ring.",
  "data": {"url": "https://raw.githubusercontent.com/JenqAu/FIT3179---fix/refs/heads/backup-main/data/nba_team_championships.csv"},
  "background": "transparent",

  "params": [
    {
      "name": "selectedEra",
      "value": "All",
      "bind": {
        "input": "select",
        "options": ["All", "Classic", "Modern"],
        "name": "Dynasty Era: "
      }
    }
  ],

  "transform": [
    {"calculate": "toNumber(datum.Championships)", "as": "rings"},
    {"filter": "datum.Championships > 1"},
    {"calculate": "sequence(0, 20)", "as": "ring_sequence"},
    {"flatten": ["ring_sequence"], "as": ["ring_index"]},
    {"calculate": "floor(datum.ring_index / 5)", "as": "row"},
    {"calculate": "datum.ring_index % 5", "as": "col"},
    {
      "calculate": "datum.PeakEra == '60s-80s' || datum.PeakEra == '80s-00s' ? 'Classic' : 'Modern'",
      "as": "EraGroup"
    },
    {"filter": "selectedEra == 'All' ? true : datum.EraGroup == selectedEra"}
  ],

  "padding": {"left": 0, "top": 12, "right": 0, "bottom": 0},
  "columns": 4,
  "spacing": 18,

  "facet": {
    "field": "FullName",
    "header": {
      "labelFontSize": 12,
      "labelFontWeight": "bold",
      "labelColor": "#e5f1ff",
      "title": null,
      "labelPadding": 5
    }
  },

  "spec": {
    "width": 240,
    "height": 140,
    "mark": {
      "type": "image",
      "width": 26,
      "height": 26
    },
    "encoding": {
      "x": {"field": "col", "type": "ordinal", "axis": null},
      "y": {"field": "row", "type": "ordinal", "axis": null, "sort": "-y"},
      "url": {"value": "trophy.png"},
      "opacity": {"condition": {"test": "datum.ring_index < datum.rings", "value": 1}, "value": 0.3},
  "color": {"value": "#facc15"},
      "tooltip": [
        {"field": "FullName", "title": "Team"},
        {"field": "rings", "title": "Total Championships"},
        {"field": "PeakEra", "title": "Dynasty Era"}
      ]
    }
  },

  "config": {
    "background": "transparent",
    "view": {"stroke": "transparent"},
    "axis": {"labelFontSize": 10, "titleFontSize": 12}
  }
}
